@use "../common/mixins";
@use "../common/variables";
@use "../utilities/text";

// —————————————————————————————————————————————————————————————————
// elements
// color
// notice
// bar
// dense
// noIcon
// —————————————————————————————————————————————————————————————————

$spacing-alert: variables.$spacing-sm;

// —————————————————————————————————————————————————————————————————
// elements
// —————————————————————————————————————————————————————————————————

.alert {
  border-radius: variables.$spacing-sm;
  background-color: variables.$info-light;
  color: variables.$text;
  padding: $spacing-alert $spacing-alert*2;
  position: fixed;
  top: variables.$spacing-md;
  right: variables.$spacing-md;
  width: fit-content;
  max-width: variables.$spacing-xxl*3;
  z-index: 20;

  &:not(.alert--bar) {
    padding-left: variables.$spacing-lg + variables.$spacing-sm;
  }

  @include mixins.responsive(down, mobile) {
    @include mixins.calc(max-width, '100vw - 'variables.$spacing-md);
    right: 8px;
    top: variables.$spacing-sm;
  }
  
  @include mixins.responsive(down, mobile-sm) {
    @include mixins.calc(width, '100vw - 'variables.$spacing-md);
  }

  &:before {
    content: "";
    position: absolute;
    top: $spacing-alert;
    left: variables.$spacing-sm;
    height: variables.$spacing-md*1.5;
    width: variables.$spacing-md*1.5;
    background-size: cover;
    background-repeat: no-repeat;
  }

  &__title {
    font-weight: variables.$font-bold !important;
  }

  &__subtitle {
    @extend .caption;
    padding-bottom: 0.2em;
  }

  &__close {
    transition: opacity variables.$transition-md;
    position: absolute;
    top: variables.$spacing-sm;
    right: variables.$spacing-sm;
    line-height: 0;

    svg {
      width: variables.$spacing-sm;
      height: variables.$spacing-sm;
      fill: variables.$success-dark
    }

    &:hover {
      opacity: 0.5;
    }
  }
}

// —————————————————————————————————————————————————————————————————
// color
// —————————————————————————————————————————————————————————————————

@mixin alert-color($color, $background-color: variables.$info-light, $border-color: variables.$info) {
  @if $color == success { $background-color: variables.$success-light; $border-color: variables.$success; } 
  @else if $color == info { $background-color: variables.$info-light; $border-color: variables.$info; } 
  @else if $color == warning { $background-color: variables.$warning-light; $border-color: variables.$warning; } 
  @else if $color == error { $background-color: variables.$error-light; $border-color: variables.$error; } 

  background-color: $background-color;
  border: 1px solid $border-color;
  color: variables.$text;

  // &:not(.alert--bar):before {

  //   @if $color == success { content: url(variables.$icons-path + 'phosphor/check-circle.svg'); }
  //   @else if $color == info { content: url(variables.$icons-path + 'phosphor/info.svg'); }
  //   @else if $color == warning { content: url(variables.$icons-path + 'phosphor/warning.svg'); }
  //   @else if $color == error { content: url(variables.$icons-path + 'phosphor/x-circle.svg'); }
  // }
}

.alert {

  &--success { @include alert-color(success); }
  &--info { @include alert-color(info); }
  &--warning { @include alert-color(warning); }
  &--error { @include alert-color(error); }
}

// —————————————————————————————————————————————————————————————————
// notice
// —————————————————————————————————————————————————————————————————

.alert {
  
  &--notice {
    position: relative;
    max-width: none;
    z-index: 1;
    top: 0;
    right: 0;  
  }
}

// —————————————————————————————————————————————————————————————————
// bar
// —————————————————————————————————————————————————————————————————

.alert {
  
  &--bar {
    position: fixed;
    top: 0;
    right: 0;
    max-width: none;
    width: 100%; // needed for small devices to not overflow the container
    z-index: 1;
    border-radius: 0;
    border-left: 0;
    border-right: 0;
    text-align: center;
  }
}

// —————————————————————————————————————————————————————————————————
// dense
// —————————————————————————————————————————————————————————————————

.alert--dense {
  padding: $spacing-alert*0.5 $spacing-alert;

  &:before {
    top: $spacing-alert*0.5;
    left: $spacing-alert*0.5;
    height: variables.$spacing-md*1.25;
    width: variables.$spacing-md*1.25;
  }

  &:not(.alert--bar) {
    padding-left: variables.$spacing-md*1.75;
  }

  .alert__title {

    + .alert__title,
    + .alert__subtitle {
      margin-top: 0;
    }
  }

  .alert__title { @extend .caption; }
  .alert__subtitle { @extend .overline; }
}

// —————————————————————————————————————————————————————————————————
// noIcon
// —————————————————————————————————————————————————————————————————

.alert.alert {

  &--noIcon {    
    padding-left: variables.$spacing-md;
    
    &.alert--dense {
      padding-left: variables.$spacing-sm;
    }
    
    &:before {
      display: none;
    }
  }
}
